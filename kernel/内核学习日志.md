## 基本功

- 关于数据结构组成和数据结构之间联系的小结

- 关于执行过程以及函数调用关系的小结。

![image-20220929150010415](../typora-user-images/image-20220929150010415.png)

1. 由于Windows文件不分辨大小写，但Linux区分，导致Linux源代码放到Windows上部分会发生文件名冲突
2. 由于Linux需要支持很多体系结构和兼容各种情况，使用大量宏来编译。
3. 项目太大，简单搜索需要花费大量的时间。

### 宏内核 & 微内核

### 源码下载

```
www.kernel.org   2.4.0
```

### linux 2.4.0内核目录

![image-20220929111324224](../typora-user-images/image-20220929111324224.png)

### 版本

![image-20220929112414565](../typora-user-images/image-20220929112414565.png)

### API

```
https://deepinout.com/linux-kernel-api/device-driver-and-device-management/linux-kernel-api__class_create.html
```

### LDT

局部描述符

- 数据段
- 代码段

### TSS

进程状态描述符

- 在进程运行的过程中，CPU需要知道的进程的状态标识

### GDT

![image-20221101171110238](../typora-user-images/image-20221101171110238.png)

## 学习内容

- 内存管理
  - 虚拟内存、物理内存映射
  - 内存池
  - 内存缺页、内存溢出、内存泄漏
  - ？？？malloc分配原理、malloc 1K和数据malloc 1M数据有什么区别
- 进程管理
  - 进程调度与通信模式
  - fork、execve、clone区别？docker
  - ...
- 文件系统
  - 日志效率
    - 如何提供日志吞吐量
  - Mysql落盘
    - fwrite
    - fsync
    - aio
  - vfs原理
- 操作系统调用
- 网络协议栈
- 虚拟化
  - 网卡
  - KVM

### 框架

![image-20221031105450171](../typora-user-images/image-20221031105450171.png)

![image-20221031105716578](../typora-user-images/image-20221031105716578.png)

![image-20221101113414254](../typora-user-images/image-20221101113414254.png)

### 中断体系

#### 目的

1.硬件的中断响应  ---> 内核驱动的中断

2.系统调用的函数响应（sys_call） ---> 系统调用

3.自定义中断 ---> 软件的软中断模式

4.信号中断（`kill -signalnum`） ---> 对了解信号的使用  创建  等

5.系统的异常和错误 ---> 系统的异常获取 了解系统异常的作用

#### Linux中断机制

- 硬中断和软中断
  - 硬中断：
    - 由电脑主机的`8259A`类似的硬件中断控制芯片发出的中断
    - ARM中断控制器发出的中断
  - 软中断
    - 异常
      - CPU自行保留的中断
      - 系统调用异常
- 代码结构（`linux 0.11`）
  - `asm.s`     `traps.c`
  - `system_call.s`   `frok.c  signal.c  exit.c sys.c`

#### 中断的工作流程

- 函数执行流程
  1. 做CPU工作模式的转化
  2. 进行寄存器的拷贝和压栈
  3. 设置中断异常向量表
  4. 保存正常返回的函数返回值
  5. 跳转到对应的中断服务函数上运行
  6. 进行模式的复原以及寄存器的复原
  7. 跳转回正常的函数地址继续运行

- Linux中断工作流程
  1. 将所有的寄存器值入栈
  2. 将异常码（中断号）入栈
  3. 将当前的函数返回值等进行入栈（为了在中断执行后能够找到在哪中断的，能够复原）
  4. 调用对应的中断服务函数
  5. 出栈函数返回值等
  6. 返回所有入栈的寄存器值
- ​                    中断前的处理过程，中断的恢复过程          中断的执行过程

- 硬件中断的处理过程             `asm.s`                                     `traps.c`
- 软件及系统调用的处理过程     `system_call.s`       `frok.c  signal.c  exit.c sys.c`

![image-20221031143809367](../typora-user-images/image-20221031143809367.png)

![image-20221101150847135](../typora-user-images/image-20221101150847135.png)

#### 基石

![image-20221101162503812](../typora-user-images/image-20221101162503812.png)

- 